//
//
//  Created by CloudCraze, LLC.
//  Copyright 2010 CloudCraze, LLC. All rights reserved.
//
//  Redistribution and use in source or binary forms, with or without 
//  modification is PROHIBITED.
//
//
/* ============================================================
 * Unit test for cc_svc_ShippingAndHandlingFedEx
 * 
 * ============================================================
 */
@IsTest
private class cc_svc_test_ShippingAndHandlingFedEx {
    
	private static void prepTestData() {
        cc_test_PrepTestData.loadCustomSettings();
        cc_test_PrepTestData.loadInitData();
	}

    private static testmethod void testBuildRatingServiceSelectionRequestXML(){ 
        cc_svc_test_ShippingAndHandlingFedEx.prepTestData();
        Test.startTest();
        cc_bean_ShippingOptionsRequest shipOptionsRequest = new cc_bean_ShippingOptionsRequest();
        // Build data
        shipOptionsRequest.recepientZipCode = '61614';
        shipOptionsRequest.recepientCountryCode = 'US';
        List<cc_bean_ShippingAttributes> shipAttributesList = new List<cc_bean_ShippingAttributes>();
        cc_bean_ShippingAttributes shipAttributes = new cc_bean_ShippingAttributes();       
        shipAttributes.weight = 5.5;
        shipAttributesList.add(shipAttributes);
        shipOptionsRequest.shippingAttributesList = shipAttributesList;             
        // Build data
        //cc_svc_ShippingAndHandlingFedEx cc_svc_ShippingAndHandlingFedEx = new cc_svc_ShippingAndHandlingFedEx(cc_util_CloudCraze.application.Default_Storefront__c);
        E_StorefrontSettings__c storefront = cc_util_CloudCraze.getStorefrontSettings(cc_util_CloudCraze.application.Default_Storefront__c);
        cc_svc_ShippingAndHandlingFedEx cc_svc_ShippingAndHandlingFedEx = new cc_svc_ShippingAndHandlingFedEx(storefront);
        cc_svc_ShippingAndHandlingFedEx.shippingOptionsRequest = shipOptionsRequest;
        boolean requestXmlValid = false; 
        String xmlRequest = cc_svc_ShippingAndHandlingFedEx.buildRatingServiceSelectionRequestXML();
        System.debug(xmlRequest);
        if (al.StringUtils.isNotBlank(xmlRequest)) {
            requestXmlValid = true;
        } 
        System.assertEquals(true, requestXmlValid);

        Test.stopTest();
    }
    
    private static testmethod void testGetShippingServiceAndCost(){
    	cc_svc_test_ShippingAndHandlingFedEx.prepTestData();
    	Test.startTest();
        cc_bean_ShippingOptionsRequest shipOptionsRequest = new cc_bean_ShippingOptionsRequest();
        // Build data
        shipOptionsRequest.recepientZipCode = '61614';
        shipOptionsRequest.recepientCountryCode = 'US'; 
        List<cc_bean_ShippingAttributes> shipAttributesList = new List<cc_bean_ShippingAttributes>();
        cc_bean_ShippingAttributes shipAttributes = new cc_bean_ShippingAttributes();       
        shipAttributes.weight = 5.5;
        shipAttributesList.add(shipAttributes);
        shipOptionsRequest.shippingAttributesList = shipAttributesList;
        // Build data       
        String responseXml = '<?xml version="1.0" encoding="UTF-8"?><v9:RateReply xmlns:v9="http://fedex.com/ws/rate/v9"><v9:HighestSeverity xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">SUCCESS</v9:HighestSeverity><v9:Notifications xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><v9:Severity>SUCCESS</v9:Severity><v9:Source>crs</v9:Source><v9:Code>0</v9:Code><v9:Message>Request was successfully processed. </v9:Message><v9:LocalizedMessage>Request was successfully processed. </v9:LocalizedMessage></v9:Notifications><ns:Version xmlns:ns="http://fedex.com/ws/rate/v9" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">		<ns:ServiceId>crs</ns:ServiceId>		<ns:Major>9</ns:Major>		<ns:Intermediate>0</ns:Intermediate>		<ns:Minor>0</ns:Minor>	</ns:Version><v9:RateReplyDetails xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><v9:ServiceType>PRIORITY_OVERNIGHT</v9:ServiceType><v9:PackagingType>YOUR_PACKAGING</v9:PackagingType><v9:DestinationAirportId>BWI</v9:DestinationAirportId><v9:IneligibleForMoneyBackGuarantee>false</v9:IneligibleForMoneyBackGuarantee><v9:OriginServiceArea>A2</v9:OriginServiceArea><v9:DestinationServiceArea>PM</v9:DestinationServiceArea><v9:SignatureOption>SERVICE_DEFAULT</v9:SignatureOption><v9:ActualRateType>PAYOR_ACCOUNT_PACKAGE</v9:ActualRateType><v9:RatedShipmentDetails><v9:ShipmentRateDetail><v9:RateType>PAYOR_ACCOUNT_PACKAGE</v9:RateType><v9:RateScale>1</v9:RateScale><v9:PricingCode>PACKAGE</v9:PricingCode><v9:RatedWeightMethod>ACTUAL</v9:RatedWeightMethod><v9:DimDivisor>0</v9:DimDivisor><v9:FuelSurchargePercent>8.0</v9:FuelSurchargePercent><v9:TotalBillingWeight><v9:Units>LB</v9:Units><v9:Value>5.0</v9:Value></v9:TotalBillingWeight><v9:TotalBaseCharge><v9:Currency>USD</v9:Currency><v9:Amount>34.0</v9:Amount></v9:TotalBaseCharge><v9:TotalFreightDiscounts><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalFreightDiscounts><v9:TotalNetFreight><v9:Currency>USD</v9:Currency><v9:Amount>34.0</v9:Amount></v9:TotalNetFreight><v9:TotalSurcharges><v9:Currency>USD</v9:Currency><v9:Amount>4.56</v9:Amount></v9:TotalSurcharges><v9:TotalNetFedExCharge><v9:Currency>USD</v9:Currency><v9:Amount>38.56</v9:Amount></v9:TotalNetFedExCharge><v9:TotalTaxes><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalTaxes><v9:TotalNetCharge><v9:Currency>USD</v9:Currency><v9:Amount>38.56</v9:Amount></v9:TotalNetCharge><v9:TotalRebates><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalRebates><v9:Surcharges><v9:SurchargeType>DELIVERY_AREA</v9:SurchargeType><v9:Description>Delivery Area Surcharge Extended Commercial</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.7</v9:Amount></v9:Amount></v9:Surcharges><v9:Surcharges><v9:SurchargeType>FUEL</v9:SurchargeType><v9:Description>Fuel</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>2.86</v9:Amount></v9:Amount></v9:Surcharges></v9:ShipmentRateDetail><v9:RatedPackages><v9:GroupNumber>0</v9:GroupNumber><v9:PackageRateDetail><v9:RateType>PAYOR_ACCOUNT_PACKAGE</v9:RateType><v9:RatedWeightMethod>ACTUAL</v9:RatedWeightMethod><v9:BillingWeight><v9:Units>LB</v9:Units><v9:Value>5.0</v9:Value></v9:BillingWeight><v9:BaseCharge><v9:Currency>USD</v9:Currency><v9:Amount>34.0</v9:Amount></v9:BaseCharge><v9:TotalFreightDiscounts><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalFreightDiscounts><v9:NetFreight><v9:Currency>USD</v9:Currency><v9:Amount>34.0</v9:Amount></v9:NetFreight><v9:TotalSurcharges><v9:Currency>USD</v9:Currency><v9:Amount>4.56</v9:Amount></v9:TotalSurcharges><v9:NetFedExCharge><v9:Currency>USD</v9:Currency><v9:Amount>38.56</v9:Amount></v9:NetFedExCharge><v9:TotalTaxes><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalTaxes><v9:NetCharge><v9:Currency>USD</v9:Currency><v9:Amount>38.56</v9:Amount></v9:NetCharge><v9:TotalRebates><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalRebates><v9:Surcharges><v9:SurchargeType>DELIVERY_AREA</v9:SurchargeType><v9:Description>Delivery Area Surcharge Extended Commercial</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.7</v9:Amount></v9:Amount></v9:Surcharges><v9:Surcharges><v9:SurchargeType>FUEL</v9:SurchargeType><v9:Description>Fuel</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>2.86</v9:Amount></v9:Amount></v9:Surcharges></v9:PackageRateDetail></v9:RatedPackages></v9:RatedShipmentDetails><v9:RatedShipmentDetails><v9:ShipmentRateDetail><v9:RateType>RATED_ACCOUNT_PACKAGE</v9:RateType><v9:RateScale>1</v9:RateScale><v9:PricingCode>PACKAGE</v9:PricingCode><v9:RatedWeightMethod>ACTUAL</v9:RatedWeightMethod><v9:DimDivisor>0</v9:DimDivisor><v9:FuelSurchargePercent>8.0</v9:FuelSurchargePercent><v9:TotalBillingWeight><v9:Units>LB</v9:Units><v9:Value>5.0</v9:Value></v9:TotalBillingWeight><v9:TotalBaseCharge><v9:Currency>USD</v9:Currency><v9:Amount>34.0</v9:Amount></v9:TotalBaseCharge><v9:TotalFreightDiscounts><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalFreightDiscounts><v9:TotalNetFreight><v9:Currency>USD</v9:Currency><v9:Amount>34.0</v9:Amount></v9:TotalNetFreight><v9:TotalSurcharges><v9:Currency>USD</v9:Currency><v9:Amount>4.56</v9:Amount></v9:TotalSurcharges><v9:TotalNetFedExCharge><v9:Currency>USD</v9:Currency><v9:Amount>38.56</v9:Amount></v9:TotalNetFedExCharge><v9:TotalTaxes><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalTaxes><v9:TotalNetCharge><v9:Currency>USD</v9:Currency><v9:Amount>38.56</v9:Amount></v9:TotalNetCharge><v9:TotalRebates><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalRebates><v9:Surcharges><v9:SurchargeType>DELIVERY_AREA</v9:SurchargeType><v9:Description>Delivery Area Surcharge Extended Commercial</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.7</v9:Amount></v9:Amount></v9:Surcharges><v9:Surcharges><v9:SurchargeType>FUEL</v9:SurchargeType><v9:Description>Fuel</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>2.86</v9:Amount></v9:Amount></v9:Surcharges></v9:ShipmentRateDetail><v9:RatedPackages><v9:GroupNumber>0</v9:GroupNumber><v9:PackageRateDetail><v9:RateType>RATED_ACCOUNT_PACKAGE</v9:RateType><v9:RatedWeightMethod>ACTUAL</v9:RatedWeightMethod><v9:BillingWeight><v9:Units>LB</v9:Units><v9:Value>5.0</v9:Value></v9:BillingWeight><v9:BaseCharge><v9:Currency>USD</v9:Currency><v9:Amount>34.0</v9:Amount></v9:BaseCharge><v9:TotalFreightDiscounts><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalFreightDiscounts><v9:NetFreight><v9:Currency>USD</v9:Currency><v9:Amount>34.0</v9:Amount></v9:NetFreight><v9:TotalSurcharges><v9:Currency>USD</v9:Currency><v9:Amount>4.56</v9:Amount></v9:TotalSurcharges><v9:NetFedExCharge><v9:Currency>USD</v9:Currency><v9:Amount>38.56</v9:Amount></v9:NetFedExCharge><v9:TotalTaxes><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalTaxes><v9:NetCharge><v9:Currency>USD</v9:Currency><v9:Amount>38.56</v9:Amount></v9:NetCharge><v9:TotalRebates><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalRebates><v9:Surcharges><v9:SurchargeType>DELIVERY_AREA</v9:SurchargeType><v9:Description>Delivery Area Surcharge Extended Commercial</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.7</v9:Amount></v9:Amount></v9:Surcharges><v9:Surcharges><v9:SurchargeType>FUEL</v9:SurchargeType><v9:Description>Fuel</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>2.86</v9:Amount></v9:Amount></v9:Surcharges></v9:PackageRateDetail></v9:RatedPackages></v9:RatedShipmentDetails></v9:RateReplyDetails><v9:RateReplyDetails xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><v9:ServiceType>FEDEX_2_DAY</v9:ServiceType><v9:PackagingType>YOUR_PACKAGING</v9:PackagingType><v9:DestinationAirportId>BWI</v9:DestinationAirportId><v9:IneligibleForMoneyBackGuarantee>false</v9:IneligibleForMoneyBackGuarantee><v9:OriginServiceArea>A2</v9:OriginServiceArea><v9:DestinationServiceArea>PM</v9:DestinationServiceArea><v9:SignatureOption>SERVICE_DEFAULT</v9:SignatureOption><v9:ActualRateType>PAYOR_ACCOUNT_PACKAGE</v9:ActualRateType><v9:RatedShipmentDetails><v9:ShipmentRateDetail><v9:RateType>PAYOR_ACCOUNT_PACKAGE</v9:RateType><v9:RateScale>6068</v9:RateScale><v9:RateZone>6</v9:RateZone><v9:PricingCode>PACKAGE</v9:PricingCode><v9:RatedWeightMethod>ACTUAL</v9:RatedWeightMethod><v9:DimDivisor>0</v9:DimDivisor><v9:FuelSurchargePercent>8.0</v9:FuelSurchargePercent><v9:TotalBillingWeight><v9:Units>LB</v9:Units><v9:Value>5.0</v9:Value></v9:TotalBillingWeight><v9:TotalBaseCharge><v9:Currency>USD</v9:Currency><v9:Amount>26.5</v9:Amount></v9:TotalBaseCharge><v9:TotalFreightDiscounts><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalFreightDiscounts><v9:TotalNetFreight><v9:Currency>USD</v9:Currency><v9:Amount>26.5</v9:Amount></v9:TotalNetFreight><v9:TotalSurcharges><v9:Currency>USD</v9:Currency><v9:Amount>3.96</v9:Amount></v9:TotalSurcharges><v9:TotalNetFedExCharge><v9:Currency>USD</v9:Currency><v9:Amount>30.46</v9:Amount></v9:TotalNetFedExCharge><v9:TotalTaxes><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalTaxes><v9:TotalNetCharge><v9:Currency>USD</v9:Currency><v9:Amount>30.46</v9:Amount></v9:TotalNetCharge><v9:TotalRebates><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalRebates><v9:Surcharges><v9:SurchargeType>DELIVERY_AREA</v9:SurchargeType><v9:Description>Delivery Area Surcharge Extended Commercial</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.7</v9:Amount></v9:Amount></v9:Surcharges><v9:Surcharges><v9:SurchargeType>FUEL</v9:SurchargeType><v9:Description>Fuel</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>2.26</v9:Amount></v9:Amount></v9:Surcharges></v9:ShipmentRateDetail><v9:RatedPackages><v9:GroupNumber>0</v9:GroupNumber><v9:PackageRateDetail><v9:RateType>PAYOR_ACCOUNT_PACKAGE</v9:RateType><v9:RatedWeightMethod>ACTUAL</v9:RatedWeightMethod><v9:BillingWeight><v9:Units>LB</v9:Units><v9:Value>5.0</v9:Value></v9:BillingWeight><v9:BaseCharge><v9:Currency>USD</v9:Currency><v9:Amount>26.5</v9:Amount></v9:BaseCharge><v9:TotalFreightDiscounts><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalFreightDiscounts><v9:NetFreight><v9:Currency>USD</v9:Currency><v9:Amount>26.5</v9:Amount></v9:NetFreight><v9:TotalSurcharges><v9:Currency>USD</v9:Currency><v9:Amount>3.96</v9:Amount></v9:TotalSurcharges><v9:NetFedExCharge><v9:Currency>USD</v9:Currency><v9:Amount>30.46</v9:Amount></v9:NetFedExCharge><v9:TotalTaxes><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalTaxes><v9:NetCharge><v9:Currency>USD</v9:Currency><v9:Amount>30.46</v9:Amount></v9:NetCharge><v9:TotalRebates><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalRebates><v9:Surcharges><v9:SurchargeType>DELIVERY_AREA</v9:SurchargeType><v9:Description>Delivery Area Surcharge Extended Commercial</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.7</v9:Amount></v9:Amount></v9:Surcharges><v9:Surcharges><v9:SurchargeType>FUEL</v9:SurchargeType><v9:Description>Fuel</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>2.26</v9:Amount></v9:Amount></v9:Surcharges></v9:PackageRateDetail></v9:RatedPackages></v9:RatedShipmentDetails><v9:RatedShipmentDetails><v9:ShipmentRateDetail><v9:RateType>RATED_ACCOUNT_PACKAGE</v9:RateType><v9:RateScale>6068</v9:RateScale><v9:RateZone>6</v9:RateZone><v9:PricingCode>PACKAGE</v9:PricingCode><v9:RatedWeightMethod>ACTUAL</v9:RatedWeightMethod><v9:DimDivisor>0</v9:DimDivisor><v9:FuelSurchargePercent>8.0</v9:FuelSurchargePercent><v9:TotalBillingWeight><v9:Units>LB</v9:Units><v9:Value>5.0</v9:Value></v9:TotalBillingWeight><v9:TotalBaseCharge><v9:Currency>USD</v9:Currency><v9:Amount>26.5</v9:Amount></v9:TotalBaseCharge><v9:TotalFreightDiscounts><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalFreightDiscounts><v9:TotalNetFreight><v9:Currency>USD</v9:Currency><v9:Amount>26.5</v9:Amount></v9:TotalNetFreight><v9:TotalSurcharges><v9:Currency>USD</v9:Currency><v9:Amount>3.96</v9:Amount></v9:TotalSurcharges><v9:TotalNetFedExCharge><v9:Currency>USD</v9:Currency><v9:Amount>30.46</v9:Amount></v9:TotalNetFedExCharge><v9:TotalTaxes><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalTaxes><v9:TotalNetCharge><v9:Currency>USD</v9:Currency><v9:Amount>30.46</v9:Amount></v9:TotalNetCharge><v9:TotalRebates><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalRebates><v9:Surcharges><v9:SurchargeType>DELIVERY_AREA</v9:SurchargeType><v9:Description>Delivery Area Surcharge Extended Commercial</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.7</v9:Amount></v9:Amount></v9:Surcharges><v9:Surcharges><v9:SurchargeType>FUEL</v9:SurchargeType><v9:Description>Fuel</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>2.26</v9:Amount></v9:Amount></v9:Surcharges></v9:ShipmentRateDetail><v9:RatedPackages><v9:GroupNumber>0</v9:GroupNumber><v9:PackageRateDetail><v9:RateType>RATED_ACCOUNT_PACKAGE</v9:RateType><v9:RatedWeightMethod>ACTUAL</v9:RatedWeightMethod><v9:BillingWeight><v9:Units>LB</v9:Units><v9:Value>5.0</v9:Value></v9:BillingWeight><v9:BaseCharge><v9:Currency>USD</v9:Currency><v9:Amount>26.5</v9:Amount></v9:BaseCharge><v9:TotalFreightDiscounts><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalFreightDiscounts><v9:NetFreight><v9:Currency>USD</v9:Currency><v9:Amount>26.5</v9:Amount></v9:NetFreight><v9:TotalSurcharges><v9:Currency>USD</v9:Currency><v9:Amount>3.96</v9:Amount></v9:TotalSurcharges><v9:NetFedExCharge><v9:Currency>USD</v9:Currency><v9:Amount>30.46</v9:Amount></v9:NetFedExCharge><v9:TotalTaxes><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalTaxes><v9:NetCharge><v9:Currency>USD</v9:Currency><v9:Amount>30.46</v9:Amount></v9:NetCharge><v9:TotalRebates><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalRebates><v9:Surcharges><v9:SurchargeType>DELIVERY_AREA</v9:SurchargeType><v9:Description>Delivery Area Surcharge Extended Commercial</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.7</v9:Amount></v9:Amount></v9:Surcharges><v9:Surcharges><v9:SurchargeType>FUEL</v9:SurchargeType><v9:Description>Fuel</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>2.26</v9:Amount></v9:Amount></v9:Surcharges></v9:PackageRateDetail></v9:RatedPackages></v9:RatedShipmentDetails></v9:RateReplyDetails><v9:RateReplyDetails xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><v9:ServiceType>FEDEX_EXPRESS_SAVER</v9:ServiceType><v9:PackagingType>YOUR_PACKAGING</v9:PackagingType><v9:DestinationAirportId>BWI</v9:DestinationAirportId><v9:IneligibleForMoneyBackGuarantee>false</v9:IneligibleForMoneyBackGuarantee><v9:OriginServiceArea>A2</v9:OriginServiceArea><v9:DestinationServiceArea>PM</v9:DestinationServiceArea><v9:SignatureOption>SERVICE_DEFAULT</v9:SignatureOption><v9:ActualRateType>PAYOR_ACCOUNT_PACKAGE</v9:ActualRateType><v9:RatedShipmentDetails><v9:ShipmentRateDetail><v9:RateType>PAYOR_ACCOUNT_PACKAGE</v9:RateType><v9:RateScale>7175</v9:RateScale><v9:RateZone>6</v9:RateZone><v9:PricingCode>PACKAGE</v9:PricingCode><v9:RatedWeightMethod>ACTUAL</v9:RatedWeightMethod><v9:DimDivisor>0</v9:DimDivisor><v9:FuelSurchargePercent>8.0</v9:FuelSurchargePercent><v9:TotalBillingWeight><v9:Units>LB</v9:Units><v9:Value>5.0</v9:Value></v9:TotalBillingWeight><v9:TotalBaseCharge><v9:Currency>USD</v9:Currency><v9:Amount>18.4</v9:Amount></v9:TotalBaseCharge><v9:TotalFreightDiscounts><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalFreightDiscounts><v9:TotalNetFreight><v9:Currency>USD</v9:Currency><v9:Amount>18.4</v9:Amount></v9:TotalNetFreight><v9:TotalSurcharges><v9:Currency>USD</v9:Currency><v9:Amount>3.31</v9:Amount></v9:TotalSurcharges><v9:TotalNetFedExCharge><v9:Currency>USD</v9:Currency><v9:Amount>21.71</v9:Amount></v9:TotalNetFedExCharge><v9:TotalTaxes><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalTaxes><v9:TotalNetCharge><v9:Currency>USD</v9:Currency><v9:Amount>21.71</v9:Amount></v9:TotalNetCharge><v9:TotalRebates><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalRebates><v9:Surcharges><v9:SurchargeType>DELIVERY_AREA</v9:SurchargeType><v9:Description>Delivery Area Surcharge Extended Commercial</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.7</v9:Amount></v9:Amount></v9:Surcharges><v9:Surcharges><v9:SurchargeType>FUEL</v9:SurchargeType><v9:Description>Fuel</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.61</v9:Amount></v9:Amount></v9:Surcharges></v9:ShipmentRateDetail><v9:RatedPackages><v9:GroupNumber>0</v9:GroupNumber><v9:PackageRateDetail><v9:RateType>PAYOR_ACCOUNT_PACKAGE</v9:RateType><v9:RatedWeightMethod>ACTUAL</v9:RatedWeightMethod><v9:BillingWeight><v9:Units>LB</v9:Units><v9:Value>5.0</v9:Value></v9:BillingWeight><v9:BaseCharge><v9:Currency>USD</v9:Currency><v9:Amount>18.4</v9:Amount></v9:BaseCharge><v9:TotalFreightDiscounts><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalFreightDiscounts><v9:NetFreight><v9:Currency>USD</v9:Currency><v9:Amount>18.4</v9:Amount></v9:NetFreight><v9:TotalSurcharges><v9:Currency>USD</v9:Currency><v9:Amount>3.31</v9:Amount></v9:TotalSurcharges><v9:NetFedExCharge><v9:Currency>USD</v9:Currency><v9:Amount>21.71</v9:Amount></v9:NetFedExCharge><v9:TotalTaxes><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalTaxes><v9:NetCharge><v9:Currency>USD</v9:Currency><v9:Amount>21.71</v9:Amount></v9:NetCharge><v9:TotalRebates><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalRebates><v9:Surcharges><v9:SurchargeType>DELIVERY_AREA</v9:SurchargeType><v9:Description>Delivery Area Surcharge Extended Commercial</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.7</v9:Amount></v9:Amount></v9:Surcharges><v9:Surcharges><v9:SurchargeType>FUEL</v9:SurchargeType><v9:Description>Fuel</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.61</v9:Amount></v9:Amount></v9:Surcharges></v9:PackageRateDetail></v9:RatedPackages></v9:RatedShipmentDetails><v9:RatedShipmentDetails><v9:ShipmentRateDetail><v9:RateType>RATED_ACCOUNT_PACKAGE</v9:RateType><v9:RateScale>7175</v9:RateScale><v9:RateZone>6</v9:RateZone><v9:PricingCode>PACKAGE</v9:PricingCode><v9:RatedWeightMethod>ACTUAL</v9:RatedWeightMethod><v9:DimDivisor>0</v9:DimDivisor><v9:FuelSurchargePercent>8.0</v9:FuelSurchargePercent><v9:TotalBillingWeight><v9:Units>LB</v9:Units><v9:Value>5.0</v9:Value></v9:TotalBillingWeight><v9:TotalBaseCharge><v9:Currency>USD</v9:Currency><v9:Amount>18.4</v9:Amount></v9:TotalBaseCharge><v9:TotalFreightDiscounts><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalFreightDiscounts><v9:TotalNetFreight><v9:Currency>USD</v9:Currency><v9:Amount>18.4</v9:Amount></v9:TotalNetFreight><v9:TotalSurcharges><v9:Currency>USD</v9:Currency><v9:Amount>3.31</v9:Amount></v9:TotalSurcharges><v9:TotalNetFedExCharge><v9:Currency>USD</v9:Currency><v9:Amount>21.71</v9:Amount></v9:TotalNetFedExCharge><v9:TotalTaxes><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalTaxes><v9:TotalNetCharge><v9:Currency>USD</v9:Currency><v9:Amount>21.71</v9:Amount></v9:TotalNetCharge><v9:TotalRebates><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalRebates><v9:Surcharges><v9:SurchargeType>DELIVERY_AREA</v9:SurchargeType><v9:Description>Delivery Area Surcharge Extended Commercial</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.7</v9:Amount></v9:Amount></v9:Surcharges><v9:Surcharges><v9:SurchargeType>FUEL</v9:SurchargeType><v9:Description>Fuel</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.61</v9:Amount></v9:Amount></v9:Surcharges></v9:ShipmentRateDetail><v9:RatedPackages><v9:GroupNumber>0</v9:GroupNumber><v9:PackageRateDetail><v9:RateType>RATED_ACCOUNT_PACKAGE</v9:RateType><v9:RatedWeightMethod>ACTUAL</v9:RatedWeightMethod><v9:BillingWeight><v9:Units>LB</v9:Units><v9:Value>5.0</v9:Value></v9:BillingWeight><v9:BaseCharge><v9:Currency>USD</v9:Currency><v9:Amount>18.4</v9:Amount></v9:BaseCharge><v9:TotalFreightDiscounts><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalFreightDiscounts><v9:NetFreight><v9:Currency>USD</v9:Currency><v9:Amount>18.4</v9:Amount></v9:NetFreight><v9:TotalSurcharges><v9:Currency>USD</v9:Currency><v9:Amount>3.31</v9:Amount></v9:TotalSurcharges><v9:NetFedExCharge><v9:Currency>USD</v9:Currency><v9:Amount>21.71</v9:Amount></v9:NetFedExCharge><v9:TotalTaxes><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalTaxes><v9:NetCharge><v9:Currency>USD</v9:Currency><v9:Amount>21.71</v9:Amount></v9:NetCharge><v9:TotalRebates><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalRebates><v9:Surcharges><v9:SurchargeType>DELIVERY_AREA</v9:SurchargeType><v9:Description>Delivery Area Surcharge Extended Commercial</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.7</v9:Amount></v9:Amount></v9:Surcharges><v9:Surcharges><v9:SurchargeType>FUEL</v9:SurchargeType><v9:Description>Fuel</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.61</v9:Amount></v9:Amount></v9:Surcharges></v9:PackageRateDetail></v9:RatedPackages></v9:RatedShipmentDetails></v9:RateReplyDetails><v9:RateReplyDetails xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><v9:ServiceType>FEDEX_GROUND</v9:ServiceType><v9:PackagingType>YOUR_PACKAGING</v9:PackagingType><v9:DestinationAirportId>BWI</v9:DestinationAirportId><v9:IneligibleForMoneyBackGuarantee>false</v9:IneligibleForMoneyBackGuarantee><v9:OriginServiceArea>A2</v9:OriginServiceArea><v9:DestinationServiceArea>PM</v9:DestinationServiceArea><v9:SignatureOption>SERVICE_DEFAULT</v9:SignatureOption><v9:ActualRateType>PAYOR_ACCOUNT_PACKAGE</v9:ActualRateType><v9:RatedShipmentDetails><v9:ShipmentRateDetail><v9:RateType>PAYOR_ACCOUNT_PACKAGE</v9:RateType><v9:RateZone>6</v9:RateZone><v9:RatedWeightMethod>ACTUAL</v9:RatedWeightMethod><v9:DimDivisor>0</v9:DimDivisor><v9:FuelSurchargePercent>6.0</v9:FuelSurchargePercent><v9:TotalBillingWeight><v9:Units>LB</v9:Units><v9:Value>5.0</v9:Value></v9:TotalBillingWeight><v9:TotalBaseCharge><v9:Currency>USD</v9:Currency><v9:Amount>7.83</v9:Amount></v9:TotalBaseCharge><v9:TotalFreightDiscounts><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalFreightDiscounts><v9:TotalNetFreight><v9:Currency>USD</v9:Currency><v9:Amount>7.83</v9:Amount></v9:TotalNetFreight><v9:TotalSurcharges><v9:Currency>USD</v9:Currency><v9:Amount>2.43</v9:Amount></v9:TotalSurcharges><v9:TotalNetFedExCharge><v9:Currency>USD</v9:Currency><v9:Amount>10.26</v9:Amount></v9:TotalNetFedExCharge><v9:TotalTaxes><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalTaxes><v9:TotalNetCharge><v9:Currency>USD</v9:Currency><v9:Amount>10.26</v9:Amount></v9:TotalNetCharge><v9:TotalRebates><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalRebates><v9:Surcharges><v9:SurchargeType>DELIVERY_AREA</v9:SurchargeType><v9:Level>PACKAGE</v9:Level><v9:Description>Delivery Area Surcharge Extended Commercial</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.85</v9:Amount></v9:Amount></v9:Surcharges><v9:Surcharges><v9:SurchargeType>FUEL</v9:SurchargeType><v9:Level>PACKAGE</v9:Level><v9:Description>FedEx Ground Fuel</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>0.58</v9:Amount></v9:Amount></v9:Surcharges></v9:ShipmentRateDetail><v9:RatedPackages><v9:GroupNumber>0</v9:GroupNumber><v9:PackageRateDetail><v9:RateType>PAYOR_ACCOUNT_PACKAGE</v9:RateType><v9:RatedWeightMethod>ACTUAL</v9:RatedWeightMethod><v9:BillingWeight><v9:Units>LB</v9:Units><v9:Value>5.0</v9:Value></v9:BillingWeight><v9:BaseCharge><v9:Currency>USD</v9:Currency><v9:Amount>7.83</v9:Amount></v9:BaseCharge><v9:TotalFreightDiscounts><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalFreightDiscounts><v9:NetFreight><v9:Currency>USD</v9:Currency><v9:Amount>7.83</v9:Amount></v9:NetFreight><v9:TotalSurcharges><v9:Currency>USD</v9:Currency><v9:Amount>2.43</v9:Amount></v9:TotalSurcharges><v9:NetFedExCharge><v9:Currency>USD</v9:Currency><v9:Amount>10.26</v9:Amount></v9:NetFedExCharge><v9:TotalTaxes><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalTaxes><v9:NetCharge><v9:Currency>USD</v9:Currency><v9:Amount>10.26</v9:Amount></v9:NetCharge><v9:TotalRebates><v9:Currency>USD</v9:Currency><v9:Amount>0.0</v9:Amount></v9:TotalRebates><v9:Surcharges><v9:SurchargeType>DELIVERY_AREA</v9:SurchargeType><v9:Level>PACKAGE</v9:Level><v9:Description>Delivery Area Surcharge Extended Commercial</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>1.85</v9:Amount></v9:Amount></v9:Surcharges><v9:Surcharges><v9:SurchargeType>FUEL</v9:SurchargeType><v9:Level>PACKAGE</v9:Level><v9:Description>FedEx Ground Fuel</v9:Description><v9:Amount><v9:Currency>USD</v9:Currency><v9:Amount>0.58</v9:Amount></v9:Amount></v9:Surcharges></v9:PackageRateDetail></v9:RatedPackages></v9:RatedShipmentDetails></v9:RateReplyDetails></v9:RateReply>'; 
        cc_hlpr_XMLDom theXMLDom = new cc_hlpr_XMLDom(responseXml);

        //cc_svc_ShippingAndHandlingFedEx cc_svc_ShippingAndHandlingFedEx = new cc_svc_ShippingAndHandlingFedEx(cc_util_CloudCraze.application.Default_Storefront__c);
        E_StorefrontSettings__c storefront = cc_util_CloudCraze.getStorefrontSettings(cc_util_CloudCraze.application.Default_Storefront__c);
        cc_svc_ShippingAndHandlingFedEx cc_svc_ShippingAndHandlingFedEx = new cc_svc_ShippingAndHandlingFedEx(storefront);

        cc_svc_ShippingAndHandlingFedEx.shippingOptionsRequest = shipOptionsRequest;
        cc_bean_ShippingOptions shipOptions = cc_svc_ShippingAndHandlingFedEx.getShippingServiceAndCost(theXMLDom);
        
        System.assertEquals(true, shipOptions.status);
        System.assertEquals(cc_cnst_FedExXMLTag.SHIPPINGPROVIDER, shipOptions.shippingProvider);           
        List<cc_bean_ShippingServicesAndCostDetails> shippingServicesAndCostList = shipOptions.shippingServicesAndCostDetails;
        for (cc_bean_ShippingServicesAndCostDetails shippingServicesAndCost : shippingServicesAndCostList) {
            System.assertEquals('$', shippingServicesAndCost.currencyCode);                 
            //System.debug('-----shipService = ' + shippingServicesAndCost.shipService);
            //System.debug('-----currencyCode = ' + shippingServicesAndCost.currencyCode);
            //System.debug('-----shipCost = ' + shippingServicesAndCost.shipCost);                    
        }
            
        Test.stopTest();
    }   
}